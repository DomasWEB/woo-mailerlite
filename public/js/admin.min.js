jQuery(document).ready(function(e){var o=e("#woocommerce_mailerlite_group");if(0!==o.length){var r=o.next(".select2-container");e('<span id="woo-ml-refresh-groups" class="woo-ml-icon-refresh" data-woo-ml-refresh-groups="true"></span>').insertAfter(r)}var s=!1;e(document).on("click","[data-woo-ml-refresh-groups]",function(o){if(o.preventDefault(),!s){var r=e(this);r.removeClass("error"),r.addClass("running"),s=!0,jQuery.ajax({url:woo_ml_post.ajax_url,type:"post",data:{action:"post_woo_ml_refresh_groups"},success:function(e){e.indexOf("success")>=0&&r.removeClass("running"),e?location.reload():r.addClass("error"),s=!1}})}});var t=!1,a=0,n=0,c=0,l=e("#woo-ml-sync-untracked-orders-progress-bar"),i=0;e(document).on("click","[data-woo-ml-sync-untracked-orders]",function(o){if(o.preventDefault(),!t){t=!0,console.log("Synchronize untracked orders");var r=e(this);for(r.prop("disabled",!0),l.show(),a=r.data("woo-ml-untracked-orders-count"),n=r.data("woo-ml-untracked-orders-left"),c=r.data("woo-ml-untracked-orders-cycle"),console.log("untrackedOrdersCount >> "+a),console.log("untrackedOrdersLeft >> "+n),console.log("untrackedOrdersCycle >> "+c);n>0;)console.log("inside the loop!"),jQuery.ajax({url:woo_ml_post.ajax_url,type:"post",data:{action:"post_woo_ml_sync_untracked_orders"},async:!1,success:function(e){e.indexOf("success")>=0&&console.log("done!"),e?(console.log("Response: True"),i=100*(a-(n-=c))/a,l.find("div").css("width",i+"%")):console.log("Response: False")}});console.log("loop finished!"),r.hide(),l.hide(),e("#woo-ml-sync-untracked-orders-success").show()}});var d=e("#woocommerce_mailerlite_api_key");e('<button id="woo-ml-validate-key" class="button-primary">Validate Key</button>').insertAfter(d),e(document).on("click","#woo-ml-validate-key",function(o){if(o.preventDefault(),!s){var r=e("#woocommerce_mailerlite_api_key").val();jQuery.ajax({url:woo_ml_post.ajax_url,type:"post",data:{action:"post_woo_ml_validate_key",key:r},async:!1,success:function(e){location.reload()}})}}),e("#woocommerce_mailerlite_group").select2();var u=e("#woocommerce_mailerlite_consumer_secret");0!==u.length&&u.next(".description").closest("tr").after('<h2>Integration Details</h2><p class="section-description">Customize MailerLite integration for WooCommerce</p>');e("#woocommerce_mailerlite_popups").closest("tr").before('<h2>Pop-ups</h2><p class="section-description">Display pop-up subscribe forms created within MailerLite</p>')});