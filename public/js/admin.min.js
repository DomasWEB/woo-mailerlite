jQuery(document).ready(function(o){var e=o("#woocommerce_mailerlite_group");if(0!==e.length){var r=e.next(".select2-container");o('<span id="woo-ml-refresh-groups" class="woo-ml-icon-refresh" data-woo-ml-refresh-groups="true"></span>').insertAfter(r)}var s=!1;o(document).on("click","[data-woo-ml-refresh-groups]",function(e){if(e.preventDefault(),!s){var r=o(this);r.removeClass("error"),r.addClass("running"),s=!0,jQuery.ajax({url:woo_ml_post.ajax_url,type:"post",data:{action:"post_woo_ml_refresh_groups"},success:function(o){o.indexOf("success")>=0&&r.removeClass("running"),o?location.reload():r.addClass("error"),s=!1}})}});var a=!1,t=0,n=0,l=0,c=o("#woo-ml-sync-untracked-orders-progress-bar"),d=0;o(document).on("click","[data-woo-ml-sync-untracked-orders]",function(e){if(e.preventDefault(),!a){a=!0,console.log("Synchronize untracked orders");var r=o(this);for(r.prop("disabled",!0),c.show(),t=r.data("woo-ml-untracked-orders-count"),n=r.data("woo-ml-untracked-orders-left"),l=r.data("woo-ml-untracked-orders-cycle"),console.log("untrackedOrdersCount >> "+t),console.log("untrackedOrdersLeft >> "+n),console.log("untrackedOrdersCycle >> "+l);n>0;)console.log("inside the loop!"),jQuery.ajax({url:woo_ml_post.ajax_url,type:"post",data:{action:"post_woo_ml_sync_untracked_orders"},async:!1,success:function(o){o.indexOf("success")>=0&&console.log("done!"),o?(console.log("Response: True"),d=100*(t-(n-=l))/t,c.find("div").css("width",d+"%")):console.log("Response: False")}});console.log("loop finished!"),r.hide(),c.hide(),o("#woo-ml-sync-untracked-orders-success").show()}});var i=o("#woocommerce_mailerlite_api_key");o('<button id="woo-ml-validate-key" class="button-primary">Validate Key</button>').insertAfter(i),o(document).on("click","#woo-ml-validate-key",function(e){if(e.preventDefault(),!s){var r=o("#woocommerce_mailerlite_api_key").val();jQuery.ajax({url:woo_ml_post.ajax_url,type:"post",data:{action:"post_woo_ml_validate_key",key:r},async:!1,success:function(o){location.reload()}})}}),o("#woocommerce_mailerlite_group").select2()});